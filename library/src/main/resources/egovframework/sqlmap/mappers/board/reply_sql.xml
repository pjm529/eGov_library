<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="Reply">

	<resultMap id="replyMap" type="ReplyVO">
		<id column="reply_no"				property="replyNo" />
		<result column="notice_no"			property="noticeNo" />
		<result column="reply_content"		property="replyContent" />
		<result column="writer_id"	 		property="writerId" />
		<result column="writer_name"	 	property="writerName" />
		<result column="reply_reg_date" 	property="replyRegDate" />
	</resultMap> 

	<!-- 댓글 입력 -->
	<insert id="insertReply" parameterType="ReplyVO">
		<![CDATA[
			INSERT INTO
				reply (notice_no, reply_content, writer_id, writer_name)
			VALUES
				(#{noticeNo}, #{replyContent}, #{writerId}, #{writerName})				
		]]>
	</insert>
	
	<!-- 댓글 목록 -->
	<select id="replyList" parameterType="long" resultMap="replyMap">
		<![CDATA[
			SELECT
				*
			FROM
				reply
			WHERE
				notice_no = #{noticeNo}
			ORDER BY
				reply_reg_date				
		]]>
	</select>
	
	<!-- 댓글 삭제 -->
	<delete id="deleteReply" parameterType="int">
		<![CDATA[
			DELETE
			FROM
				reply
			WHERE
				reply_no = #{replyNo}
		]]>
	</delete>
	
	<!-- 댓글 작성자 검색 -->
	<select id="searchWriter" parameterType="int" resultType="string">
		<![CDATA[
			SELECT
				writer_id
			FROM
				reply
			WHERE
				reply_no = #{replyNo}
		]]>
	</select>
	
	<update id="modifyReply" parameterType="ReplyVO">
		<![CDATA[
			UPDATE
				reply
			SET
				reply_content = #{replyContent},
				reply_modify_date = current_timestamp()
			WHERE
				reply_no = #{replyNo} AND
				writer_id = #{writerId}
		]]>
	</update>
</mapper>
